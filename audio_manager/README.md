# Audio Manager

A comprehensive Python package for managing, storing, and retrieving audio recordings and their associated metadata across multiple storage backends.

## Overview

Audio Manager is designed to help applications track and manage audio recordings, whether they're generated by AI systems or recorded by users. It provides functionality to:

- Register and catalog audio recordings
- Store rich metadata about recordings
- Track AI and user identities associated with recordings
- Manage file storage across different backends (local, S3, SCP)
- Search and retrieve recordings based on various criteria

## Features

### Recording Management
- Register recordings with transcriptions and metadata
- Associate recordings with AI models/voices or user identities
- Organize recordings across different storage locations
- Search recordings by content or attributes

### Identity Tracking
- Track AI models and voices used to generate audio
- Maintain user identity information associated with recordings

### File Operations
- Push recordings to remote storage (S3, SCP)
- Pull recordings from remote storage to local filesystem
- Automatic directory creation and path management

### Storage Backends
- Local filesystem storage
- Amazon S3 cloud storage
- Remote server storage via SCP/SSH

## Installation

```bash
# Install from PyPI
pip install audio-manager

# Install from source
git clone https://github.com/yourusername/audio-manager.git
cd audio-manager
pip install -e .
```

## Configuration

Audio Manager can be configured through a YAML file:

```yaml
audio_manager:
  db_path: "/path/to/registry.db"
  locations:
    local:
      type: "local"
      path: "/path/to/audio/files"  # REQUIRED: Local path is always needed for push/pull operations
    s3:
      type: "s3"
      bucket: "your-bucket-name"
      aws_access_key_id: "YOUR_ACCESS_KEY"
      aws_secret_access_key: "YOUR_SECRET_KEY"
      region_name: "us-west-2"
    remote:
      type: "scp"
      host: "your-server.example.com"
      user: "username"
      identity_file: "/path/to/ssh/key"
      remote_path: "/remote/path/to/audio"
```

**Important**: The `local` location with a valid path is always required, as it serves as either the source or destination for all file transfer operations.

## Usage Examples

### Command Line Interface

Audio Manager provides a command-line interface for all operations:

```bash
# Register an AI identity
audio_manager register-ai-identity --model "gpt-4" --voice "echo"

# Register a user identity
audio_manager register-user-identity --first-name "John" --last-name "Doe" --username "jdoe"

# Register a recording
audio_manager register-recording --text "Hello world" --model "whisper" --audio-file "/path/to/audio.wav"

# Find a recording by text content
audio_manager find-recording --text "Hello world"

# List all recordings
audio_manager list-recordings

# Push a recording to a remote location
audio_manager push-recording 12345678-1234-5678-1234-567812345678 --destination s3

# Pull a recording from a remote location
audio_manager pull-recording 12345678-1234-5678-1234-567812345678

# View configuration
audio_manager config --show
```

### Python API

```python
from audio_manager import AudioManager

# Initialize the manager
manager = AudioManager(config_path="config.yaml")

# Register identities
ai_id = manager.register_ai_identity(ai_model="whisper", ai_voice="echo")
user_id = manager.register_user_identity(first_name="John", last_name="Doe")

# Register a recording
file_paths = {
    "audio": "/path/to/audio.wav",
    "transcript": "/path/to/transcript.txt"
}

recording_id = manager.register_recording(
    text="Hello world",
    model="whisper",
    ai_generated=True,
    ai_identity_id=ai_id,
    file_paths=file_paths
)

# Find a recording
recording = manager.find_by_text("Hello world")

# Push to remote storage
manager.push_recording(recording_id)

# Pull from remote storage
manager.pull_recording(recording_id)
```

## Database Schema

Audio Manager uses a SQLite database with the following tables:

- **recordings**: Core recording metadata
- **ai_identities**: Information about AI models and voices
- **user_identities**: Information about users
- **recording_files**: Paths and types of files associated with recordings

## Requirements

- Python 3.7+
- boto3 (for S3 support)
- paramiko (for SCP support)
- pyyaml
- sqlite3 (included in Python standard library)


## License

This project is licensed under the BSD 3 License - see the LICENSE file for details.